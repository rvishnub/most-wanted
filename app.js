var dataObject = { 
	"272822514" : { 
	  "firstName": "Billy",
	  "lastName": "Bob",
	  "gender": "male",
	  "dob": "1/18/1949",
	  "height": 71,
	  "weight": 175,
	  "eyecolor": "brown",
	  "occupation": "programmer",
	  "parents": [],
	  "currentSpouse": 401222887 
	},
	"401222887" : { 
	  "firstName": "Uma",
	  "lastName": "Bob",
	  "gender": "female",
	  "dob": "4/1/1947",
	  "height": 65,
	  "weight": 162,
	  "eyecolor": "brown",
	  "occupation": "assistant",
	  "parents": [],
	  "currentSpouse": 272822514 
	},
	"409574486" : { 
	  "firstName": "Michael",
	  "lastName": "Walkens",
	  "gender": "male",
	  "dob": "5/9/1951",
	  "height": 76,
	  "weight": 250,
	  "eyecolor": "brown",
	  "occupation": "landscaper",
	  "parents": [],
	  "currentSpouse": 260451248 
	},
	"260451248" : {
	  "firstName": "Jon",
	  "lastName": "Walkens",
	  "gender": "male",
	  "dob": "9/6/1945",
	  "height": 62,
	  "weight": 115,
	  "eyecolor": "brown",
	  "occupation": "assistant",
	  "parents": [],
	  "currentSpouse": 409574486 
	},
	"629807187" : {
	  "firstName": "Jack",
	  "lastName": "Pafoy",
	  "gender": "male",
	  "dob": "3/16/1938",
	  "height": 70,
	  "weight": 207,
	  "eyecolor": "black",
	  "occupation": "nurse",
	  "parents": [],
	  "currentSpouse": 464142841 
	},
	"464142841" : {
	  "firstName": "Jen",
	  "lastName": "Pafoy",
	  "gender": "female",
	  "dob": "4/10/1940",
	  "height": 72,
	  "weight": 256,
	  "eyecolor": "black",
	  "occupation": "student",
	  "parents": [],
	  "currentSpouse": 629807187 
	},
	"982411429" : {
	  "firstName": "Mister",
	  "lastName": "Potatoo",
	  "gender": "male",
	  "dob": "12/18/1952",
	  "height": 66,
	  "weight": 170,
	  "eyecolor": "hazel",
	  "occupation": "architect",
	  "parents": [],
	  "currentSpouse": 595767575 
	},
	"595767575" : {
	  "firstName": "Missuz",
	  "lastName": "Potatoo",
	  "gender": "female",
	  "dob": "10/28/1948",
	  "height": 59,
	  "weight": 137,
	  "eyecolor": "blue",
	  "occupation": "architect",
	  "parents": [],
	  "currentSpouse": 982411429 
	},
	"693243224" : {
	  "firstName": "Joy",
	  "lastName": "Madden",
	  "gender": "female",
	  "dob": "4/20/1939",
	  "height": 69,
	  "weight": 199,
	  "eyecolor": "hazel",
	  "occupation": "doctor",
	  "parents": [],
	  "currentSpouse": 888201200 
	},
	"888201200" : {
	  "firstName": "Mader",
	  "lastName": "Madden",
	  "gender": "male",
	  "dob": "5/6/1937",
	  "height": 76,
	  "weight": 205,
	  "eyecolor": "black",
	  "occupation": "landscaper",
	  "parents": [],
	  "currentSpouse": 693243224 
	},
	"878013758" : {
	  "firstName": "Jill",
	  "lastName": "Pafoy",
	  "gender": "Bob",
	  "dob": "2/8/1972",
	  "height": 74,
	  "weight": 118,
	  "eyecolor": "brown",
	  "occupation": "programmer",
	  "parents": [401222887,401222887],
	  "currentSpouse": 294874671 
	},
	"951747547" : {
	  "firstName": "Ralph",
	  "lastName": "Bob",
	  "gender": "male",
	  "dob": "12/23/1969",
	  "height": 66,
	  "weight": 179,
	  "eyecolor": "blue",
	  "occupation": "nurse",
	  "parents": [401222887,401222887],
	  "currentSpouse": 159819275 
	},
	"159819275" : {
	  "firstName": "Jasmine",
	  "lastName": "Bob",
	  "gender": "female",
	  "dob": "12/18/1969",
	  "height": 58,
	  "weight": 156,
	  "eyecolor": "blue",
	  "occupation": "assistant",
	  "parents": [409574486,260451248],
	  "currentSpouse": 951747547 
	},
	"348457184" : {
	  "firstName": "Annie",
	  "lastName": "Pafoy",
	  "gender": "female",
	  "dob": "11/4/1970",
	  "height": 62,
	  "weight": 235,
	  "eyecolor": "hazel",
	  "occupation": "landscaper",
	  "parents": [629807187,464142841],
	  "currentSpouse": null 
	},
	"294874671" : {
	  "firstName": "Dave",
	  "lastName": "Pafoy",
	  "gender": "male",
	  "dob": "8/5/1967",
	  "height": 61,
	  "weight": 112,
	  "eyecolor": "green",
	  "occupation": "doctor",
	  "parents": [629807187,464142841],
	  "currentSpouse": 878013758 
	},
	"931247228" : {
	  "firstName": "Amii",
	  "lastName": "Pafoy",
	  "gender": "female",
	  "dob": "3/13/1963",
	  "height": 74,
	  "weight": 184,
	  "eyecolor": "brown",
	  "occupation": "landscaper",
	  "parents": [629807187,464142841],
	  "currentSpouse": null 
	},
	"822843554" : {
	  "firstName": "Regina",
	  "lastName": "Madden",
	  "gender": "female",
	  "dob": "7/26/1959",
	  "height": 71,
	  "weight": 249,
	  "eyecolor": "brown",
	  "occupation": "nurse",
	  "parents": [693243224, 888201200],
	  "currentSpouse": null 
	},
	"819168108" : {
	  "firstName": "Hana",
	  "lastName": "Madden",
	  "gender": "female",
	  "dob": "10/7/1953",
	  "height": 70,
	  "weight": 187,
	  "eyecolor": "brown",
	  "occupation": "politician",
	  "parents": [693243224, 888201200],
	  "currentSpouse": null 
	},
	"969837479" : {
	  "firstName": "Eloise",
	  "lastName": "Madden",
	  "gender": "female",
	  "dob": "12/11/1961",
	  "height": 63,
	  "weight": 241,
	  "eyecolor": "brown",
	  "occupation": "assistant",
	  "parents": [693243224, 888201200],
	  "currentSpouse": null 
	},
	"313207561" : {
	  "firstName": "Mattias",
	  "lastName": "Madden",
	  "gender": "male",
	  "dob": "2/19/1966",
	  "height": 70,
	  "weight": 110,
	  "eyecolor": "blue",
	  "occupation": "assistant",
	  "parents": [693243224, 888201200],
	  "currentSpouse": 313997561 
	},
	"313997561" : {
	  "firstName": "Ellen",
	  "lastName": "Madden",
	  "gender": "female",
	  "dob": "2/19/1970",
	  "height": 67,
	  "weight": 100,
	  "eyecolor": "blue",
	  "occupation": "doctor",
	  "parents": [],
	  "currentSpouse": 313207561 
	},
	"313998000" : {
	  "firstName": "Joey",
	  "lastName": "Madden",
	  "gender": "female",
	  "dob": "2/02/1987",
	  "height": 67,
	  "weight": 100,
	  "eyecolor": "blue",
	  "occupation": "doctor",
	  "parents": [313207561,313997561],
	  "currentSpouse": null 
	},

	"313998001" : {
	  "firstName": "Renuka",
	  "lastName": "Madden",
	  "gender": "female",
	  "dob": "11/23/1987",
	  "height": 63,
	  "weight": 140,
	  "eyecolor": "brown",
	  "occupation": "programmer",
	  "parents": [313998000,],
	  "currentSpouse": null 
	}
};

/*  Remove this from your final submission
function printAllToConsole(dataObj){
	for (var key in dataObj) {
		if (dataObj.hasOwnProperty(key)) {
			console.log(key + " -> " + JSON.stringify(dataObj[key]));
		}
	}
}
printAllToConsole(dataObject);
*/

function convertObjectToArray(object){
	firstArray = [];
	for(var key in object){

		object["id"] = key;
		firstArray.push(object[key]);
	}
	return firstArray;
}
	
function pushToArray(object){
	firstArray = [];
	secondArray = [];
	firstArray = convertObjectToArray(object);
	console.log(firstArray);
	for(objectItem in firstArray)
	{
		secondArray=convertObjectToArray(objectItem);
	};
	console.log(secondArray);
	return secondArray;
}

 function getArrayOfObjects(dataObject){
	 var array = dataObject.map(function(el){
	 return convertObjectToArray;
	 });
	 console.log(array);
	 return array;
 }

function forceKeyIntoObjects(object)
{
	for (key in object)
	{
		(object[key])["id"] = key;
	}
	return object;
}



function getDescendants(personId)
{

	for (key in dataObject)
	{
		var relative = dataObject[key];
		for (idNumber in relative["parents"])
		{
			if (personId == relative["parents"][idNumber])
			{
				kidsArray.push(relative);
				getDescendants(relative.id);
			}
		}


	}
	kidsSortedArray = orderByDate(kidsArray, "dob");
	return kidsSortedArray; 
}




 function getPersonId(firstname, lastname){
	 var result;
	 try{
			 Object.keys(dataObject).forEach(function (key) {
			 if (dataObject[key]["firstName"].toLowerCase() == firstname 
				 && dataObject[key]["lastName"].toLowerCase() == lastname)
			 {
				 result = key;
			 }
		 });

		return result;
		 if (result != null){
		 	return result;
		 }
		 else
		 {
		 	alert("That name was not found. Please conduct another search.");
		 	initSearch();
		 }
	 }
	 catch (err){
		 console.log(err);
	 }

 }

function getNameInput(message){
	var yourName = prompt(message);
	nameArray = yourName.toLowerCase().split(" ");
	if (nameArray.length != 2){
		alert("Please enter a first name and a last name (example: John Doe");
		GetNameInput(message);
	}
	else{
		return nameArray;
	}

}
	 	

 function getPersonInfo(personId){
	 var result;
	 try {

	 return dataObject[personId];
	 }
	 catch (err){
		 console.log(err);
	 }

 }

function getNames(array)
{
	nameArray = [];
	
	for (objectItem in array)
	{
		yoohoo = array[objectItem];
		nameArray.push(yoohoo["firstName"] + " " + yoohoo["lastName"]);
	}
	return nameArray;
}


function getFamily(object)
{
	familyList = [];
	familyList = familyList.concat(getSpouse(object));
	familyList = familyList.concat(getParents(object));
	familyList = familyList.concat(getSiblings(object));
	familyList = familyList.concat(getChildren(object));
	return familyList;
}

function getNextOfKin(object)
{
	nextKin = [];
	nextKin = nextKin.concat(getSpouse(object));
	console.log(nextKin);
	nextKin = nextKin.concat(getChildren(object));
	console.log(nextKin);
	nextKin = nextKin.concat(getParents(object));
	console.log(nextKin);
	nextKin = nextKin.concat(getSiblings(object));
	console.log(nextKin);
	nextKin = nextKin.concat(getChildren(getChildren(object));
	nextKin = nextKin.concat(getParents(getParents(object));
	nextKin = nextKin.concat(getChildren(getSiblings(object)));
	nextKin = nextKin.concat(getSiblings(getParents(object)));
	nextKin = nextKin.concat(getChildren(getChildren(getChildren(object))));
	nextKin = nextKin.concat(getParents(getParents(getParents(object))));
	return nextKin;
}

function getSpouse(object)
{
	spouse = [];
	spouseId = object["currentSpouse"];
	spouse.push(dataObject[spouseId]);
	return spouse;
}

function getChildren(object)
{
	children = [];
	for (key in dataObject)	
	{
		person = dataObject[key];
		if (person["parents"][0] == object["id"])
		{
			children.push(person);
		}
		else if (person["parents"][1] == object["id"])
		{
			children.push(person);
		}
	
	}
	children = orderByDate(children, "dob");
	return children;
}

function getParents(object)
{
	myParents = [];
	parentArray = [];
	parentArray = object["parents"];
	for (key in parentArray)
	{
		parentID = parentArray[key];
		myParents.push(dataObject[parentID]);
	}
	myParents = orderByDate(myParents, "dob");
	return myParents;
}	

function getSiblings(object)
{
	mySiblings = [];
	for (key in dataObject)
	{
		myParents = convertObjectToArray(object["parents"])
		if (myParents.length == 0)
		{
			mySiblings = [];
			break;
		}
		else
		{
			person = dataObject[key];
			if (person["parents"][0] == object["parents"][0] && person != object)
			{
				mySiblings.push(person);
			}
		}
	}
	mySiblings = orderByDate(mySiblings, "dob");
	return mySiblings;
}


function convertObjectDOBToDate(object)
{
	
	var date = new Date(object["dob"]);
	object["dob"] = date;
	return object;
}

function orderByDate(array, dateProp)
{
	for (objectIndex in array)
	{
		convertObjectDOBToDate(array[objectIndex]);
	}
	return array.slice().sort(function (a, b)
	{
    return (a[dateProp])< b[dateProp]? -1 : 1;
	});
}


function getFilterValues(filters){
	var filterValues = [];
	try{
		for (var i = 0; i < filters.length; i++) {
			switch(filters[i]){
				case "age":
					do {age = prompt("Enter age. (Example: 50)");}
					while (age == "" || isNaN(age));
					filterValues.push(age);
					break;
				case "weight":
					do {weight = prompt("Enter weight. (Example: 150)");}
					while (weight == "" || isNaN(weight));
					filterValues.push(weight);
					break;
				case "height":
					do {height = prompt("Enter height. (Example: 6'1\")");}
					while (height == "");
					filterValues.push(height);
					break;
				case "occupation":
					do {occupation = prompt("Enter one-word occupation. (Example: programmer)");}
					while (occupation == "" || !isNaN(occupation));
					filterValues.push(occupation);
					break;
				case "age range":
					do {range = prompt("Enter age range. (Example: 40-50)");}
					while (range == "");
					filterValues.push(range);
					break;
				case "eyecolor":
					do {color = prompt("Enter eye color. (Example: brown)");}
					while (color == "" || !isNaN(color));
					filterValues.push(color);
					break;
			}
		}
		return filterValues;
	}
	catch (err)
	{
		console.log(err);
	}
}

function getFilters(){
	try{
		var filtersArray = [];
		var filters = prompt("Please enter up to five comma-separated filter options. (Example: age,height,occupation)\n\nFILTER OPTIONS:\n\nage\n\nage range\n\nheight\n\nweight\n\noccupation\n\neyecolor");
		if (filters.includes(","))
		{
			filtersArray = filters.toLowerCase().split(",");
			if (filtersArray.length>5){
				alert("You entered too many filters.");
				getFilters();
			}
		}
		else{
			if (filters != ""){
				filtersArray.push(filters);
			}
			else{
				alert("You did not enter any filters.");
				getFilters();
			}
		}
		
		return filtersArray;

	}
	catch (err){
		console.log(err);
	}


}

function runFilter(filters, values){
	try{
			var dataArray = convertObjectToArray(dataObject);
			for (var i =0; i <= filters.length; i++) {
				dataArray = dataArray.filter(function(el){
							if(el[filters[i]] == values[i]){
									return true;
								}
								else{
									return false;
								}
						});
			}
			return dataArray;
	}
	catch (err)
	{
		console.log(err);
	}

}


function initSearch(){
	var result;
	try {
		var personId;
		var nameArray;
		var search = prompt("What type of search would you like to conduct? Please enter one of the five types.\n\nTYPES\n\nname\n\ndescendants\n\nfamily\n\nnext of kin\n\nfilter");
    	// then pass that info to the respective function.
		switch (search.toLowerCase()) {
			case "name":
				nameArray = getNameInput("For whom would you like to search?");
				personId = getPersonId(nameArray[0], nameArray[nameArray.length-1]);
				result = getPersonInfo(personId);
				break;
			case "descendants":
				nameArray = getNameInput("For whose descendants would you like to search?");
				personId = getPersonId(nameArray[0], nameArray[nameArray.length-1]);
				result = getDescendants(personId);
				break;
			case "family":				
				nameArray = getNameInput("For whose family would you like to search?");
				personId = getPersonId(nameArray[0], nameArray[nameArray.length-1]);
				result = getFamily(getPersonInfo(personId));
				break;
			case "nextofkin":
				nameArray = getNameInput("For whose next of kin would you like to search?");
				personId = getPersonId(nameArray[0], nameArray[nameArray.length-1]);
				result = getNextOfKin(getPersonInfo(personId));
				break;
			case "filter":
				filters = getFilters();
				values = getFilterValues(filters);
				result = runFilter(filters, values);
				break;
			case "exit":
				window.close();
				break;
			default:
				alert("Please enter a valid search type, or exit to close application.");
				initSearch();

		}
		// once the search is done, pass the results to the responder function
		responder(result);
	}
	catch (err){
		console.log(err);
	}

}

function responder(results){

	// results may be a list of strings, an object, or a single string.
	try {

		if (results.length != 0)
		{
			alert(JSON.stringify(results));
		}
		else{
			alert("No matches found.");
		}

//		alert(results.toString());
/*		if (results.constructor === Array)
			if (results != null){
				var finalResult  = "";
				for (i=0; i<results.length; i++){
					finalResult += "\n" + results[i];
				}	
				alert(finalResult);	
			}
			else{
				alert("No results were found");
			}

		else{
		// //this works for a basic name search
			if (results != null){
				//alert(Object.keys(results).map(function(key){return results[key]}); this works
				dataArray = Object.keys(results).map(function(key){return results[key]});
				console.log(dataArray);
				alert("First name: " + dataArray[0] + "\nLast name: " + dataArray[1] + 
					"\nGender: " + dataArray[2] + "\nDate of birth: "+ dataArray[3] + "\nHeight: " + dataArray[4] + " in."+ 
					"\nWeight: " + dataArray[5] + " lbs." + "\nEye color: " + dataArray[6] +
					"\nOccupation: " + dataArray[7] + "\nParents: " + dataArray[8] +
					"\nSpouse: " + dataArray[9]);
			}
			else
			{
				alert("No match was found.");
			}

		}*/
	}
	catch (err){
		console.log(err);
	}
	finally{
		// initSearch();
	}
}


kidsArray = [];
forceKeyIntoObjects(dataObject);
initSearch();
// there will be much more here, and some of the code above will certainly change

//initSearch();
//window.close(); // exit window as the end of the session -- you may remove this
